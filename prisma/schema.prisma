generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL") // agora apontando p/ postgres?schema=public
}

model Barber {
  id           Int           @id @default(autoincrement())
  name         String
  specialty    String?
  imageUrl     String?       @map("image_url")
  rating       Decimal?      @db.Decimal(2, 1) @default(0)
  reservations Reservation[]

  @@map("Barber")
}

model Service {
  id                  Int                  @id @default(autoincrement())
  name                String
  durationMinutes     Int                  @map("duration_minutes")
  price               Decimal              @db.Decimal(10, 2)
  category            String?
  reservationServices ReservationService[]

  @@map("services")
}

model Client {
  id           Int           @id @default(autoincrement())
  name         String
  phone        String
  email        String
  cpf          String        @unique
  reservations Reservation[]

  @@map("clients")
}

model Reservation {
  id         Int                  @id @default(autoincrement())
  clientId   Int                  @map("client_id")
  barberId   Int?                 @map("barber_id")
  date       DateTime
  time       String
  totalPrice Decimal              @db.Decimal(10, 2) @map("total_price")
  createdAt  DateTime             @default(now()) @map("created_at")

  barber     Barber?              @relation(fields: [barberId], references: [id])
  client     Client               @relation(fields: [clientId], references: [id])
  services   ReservationService[]

  @@map("reservations")
}

model ReservationService {
  reservationId Int  @map("reservation_id")
  serviceId     Int  @map("service_id")

  reservation   Reservation @relation(fields: [reservationId], references: [id])
  service       Service     @relation(fields: [serviceId], references: [id])

  @@id([reservationId, serviceId])
  @@map("reservation_services")
}
